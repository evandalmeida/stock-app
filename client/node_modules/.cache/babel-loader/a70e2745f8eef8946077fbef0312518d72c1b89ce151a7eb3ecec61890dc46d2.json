{"ast":null,"code":"var _jsxFileName = \"/Users/evan/Development/code/phase-4/stock-app/client/src/components/UserPanel/MarketWatch.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { GoogleMap, LoadScript, Marker } from '@react-google-maps/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst containerStyle = {\n  width: '800px',\n  height: '400px',\n  borderRadius: '5px'\n};\nconst center = {\n  lat: 32,\n  lng: 20\n};\nconst indexFunds = {\n  'United States': {\n    name: 'S&P 500',\n    ticker: '^GSPC'\n  },\n  'Europe': {\n    name: 'Euro Stoxx 50',\n    ticker: '^STOXX50E'\n  },\n  'Asia': {\n    name: 'Nikkei 225',\n    ticker: '^N225'\n  },\n  'Australia': {\n    name: 'S&P/ASX 200',\n    ticker: '^AXJO'\n  },\n  'Canada': {\n    name: 'S&P/TSX Composite',\n    ticker: '^GSPTSE'\n  }\n};\nconst locations = [{\n  name: 'United States',\n  lat: 30.0902,\n  lng: -95.7129\n}, {\n  name: 'Europe',\n  lat: 54.5260,\n  lng: 15.2551\n}, {\n  name: 'Asia',\n  lat: 34.0479,\n  lng: 100.6197\n}, {\n  name: 'Australia',\n  lat: -30.2744,\n  lng: 133.7751\n}, {\n  name: 'Canada',\n  lat: 50.1304,\n  lng: -106.3468\n}\n// Add more locations as needed\n];\n\nexport default function MarketWatch() {\n  _s();\n  const [apiKey, setApiKey] = useState('');\n  const [error, setError] = useState(null);\n  const [locationData, setLocationData] = useState(locations);\n  const [stockData, setStockData] = useState([]); // State to store stock data\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Fetch Google Maps API key\n  useEffect(() => {\n    fetch('/api/maps/config').then(response => response.json()).then(data => setApiKey(data.apiKey)).catch(error => {\n      console.error('Error fetching Google Maps API key:', error);\n      setError('Error loading Google Maps!');\n    });\n  }, []);\n\n  // Fetch stock data based on search query\n  useEffect(() => {\n    fetch(`/api/search-stock?query=${searchQuery}`).then(response => {\n      if (!response.ok) {\n        throw new Error(`Network response was not ok: ${response.status}`);\n      }\n      return response.json();\n    }).then(data => setStockData([data])) // Assume the backend returns a single stock object\n    .catch(error => {\n      console.error(\"Error fetching stock data:\", error);\n      setError('Error loading stock!');\n    });\n  }, [searchQuery]);\n\n  // Fetch historical data for multiple tickers using your backend\n  useEffect(() => {\n    const fetchHistoricalData = async () => {\n      // You can use stockData and perform additional processing if needed\n      // For example, you can access stockData[0].symbol to get the stock symbol\n\n      // Replace this with your actual logic for fetching historical data\n      const historicalData = await fetchHistoricalDataFromBackend();\n      updateMarkers(historicalData);\n    };\n    fetchHistoricalData();\n  }, [stockData]); // Trigger when stockData changes\n\n  const updateMarkers = historicalData => {\n    if (historicalData) {\n      const updatedLocations = locationData.map(location => {\n        const indexFund = indexFunds[location.name];\n        if (indexFund && historicalData[indexFund.ticker]) {\n          const historicalPrices = historicalData[indexFund.ticker];\n          const currentPrice = historicalPrices[historicalPrices.length - 1].close;\n          const previousPrice = historicalPrices[historicalPrices.length - 2].close;\n          const isPriceIncreased = currentPrice > previousPrice;\n          return {\n            ...location,\n            isPriceIncreased\n          };\n        }\n        return location;\n      });\n      setLocationData(updatedLocations);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: error ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }, this) : apiKey ? /*#__PURE__*/_jsxDEV(LoadScript, {\n      googleMapsApiKey: apiKey,\n      children: /*#__PURE__*/_jsxDEV(GoogleMap, {\n        mapContainerStyle: containerStyle,\n        center: center,\n        zoom: 2,\n        children: locationData.map((location, index) => /*#__PURE__*/_jsxDEV(Marker, {\n          position: location,\n          title: location.name,\n          icon: {\n            url: location.isPriceIncreased ? 'https://www.freeiconspng.com/uploads/green-spot-light-png-11.png' : 'https://www.freeiconspng.com/uploads/red-spot-light-png-6.png',\n            scaledSize: {\n              width: 100,\n              height: 100\n            }\n          }\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading map...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n_s(MarketWatch, \"2j/pDLcSGo8/JosnzgTLIYTPqwk=\");\n_c = MarketWatch;\nvar _c;\n$RefreshReg$(_c, \"MarketWatch\");","map":{"version":3,"names":["React","useEffect","useState","GoogleMap","LoadScript","Marker","jsxDEV","_jsxDEV","Fragment","_Fragment","containerStyle","width","height","borderRadius","center","lat","lng","indexFunds","name","ticker","locations","MarketWatch","_s","apiKey","setApiKey","error","setError","locationData","setLocationData","stockData","setStockData","searchQuery","setSearchQuery","fetch","then","response","json","data","catch","console","ok","Error","status","fetchHistoricalData","historicalData","fetchHistoricalDataFromBackend","updateMarkers","updatedLocations","map","location","indexFund","historicalPrices","currentPrice","length","close","previousPrice","isPriceIncreased","children","fileName","_jsxFileName","lineNumber","columnNumber","googleMapsApiKey","mapContainerStyle","zoom","index","position","title","icon","url","scaledSize","_c","$RefreshReg$"],"sources":["/Users/evan/Development/code/phase-4/stock-app/client/src/components/UserPanel/MarketWatch.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { GoogleMap, LoadScript, Marker } from '@react-google-maps/api';\n\nconst containerStyle = {\n  width: '800px',\n  height: '400px',\n  borderRadius: '5px'\n};\n\nconst center = {\n  lat: 32,\n  lng: 20\n};\n\nconst indexFunds = {\n  'United States': {\n    name: 'S&P 500',\n    ticker: '^GSPC'\n  },\n  'Europe': {\n    name: 'Euro Stoxx 50',\n    ticker: '^STOXX50E'\n  },\n  'Asia': {\n    name: 'Nikkei 225',\n    ticker: '^N225'\n  },\n  'Australia': {\n    name: 'S&P/ASX 200',\n    ticker: '^AXJO'\n  },\n  'Canada': {\n    name: 'S&P/TSX Composite',\n    ticker: '^GSPTSE'\n  }\n};\n\nconst locations = [\n  {\n    name: 'United States',\n    lat: 30.0902,\n    lng: -95.7129\n  },\n  {\n    name: 'Europe',\n    lat: 54.5260,\n    lng: 15.2551\n  },\n  {\n    name: 'Asia',\n    lat: 34.0479,\n    lng: 100.6197\n  },\n  {\n    name: 'Australia',\n    lat: -30.2744,\n    lng: 133.7751\n  },\n  {\n    name: 'Canada',\n    lat: 50.1304,\n    lng: -106.3468\n  },\n  // Add more locations as needed\n];\n\nexport default function MarketWatch() {\n  const [apiKey, setApiKey] = useState('');\n  const [error, setError] = useState(null);\n  const [locationData, setLocationData] = useState(locations);\n  const [stockData, setStockData] = useState([]); // State to store stock data\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Fetch Google Maps API key\n  useEffect(() => {\n    fetch('/api/maps/config')\n      .then((response) => response.json())\n      .then((data) => setApiKey(data.apiKey))\n      .catch((error) => {\n        console.error('Error fetching Google Maps API key:', error);\n        setError('Error loading Google Maps!');\n      });\n  }, []);\n\n  // Fetch stock data based on search query\n  useEffect(() => {\n    fetch(`/api/search-stock?query=${searchQuery}`)\n      .then(response => {\n        if (!response.ok) {\n          throw new Error(`Network response was not ok: ${response.status}`);\n        }\n        return response.json();\n      })\n      .then(data => setStockData([data]))  // Assume the backend returns a single stock object\n      .catch(error => {\n        console.error(\"Error fetching stock data:\", error);\n        setError('Error loading stock!');\n      });\n  }, [searchQuery]);\n\n  // Fetch historical data for multiple tickers using your backend\n  useEffect(() => {\n    const fetchHistoricalData = async () => {\n      // You can use stockData and perform additional processing if needed\n      // For example, you can access stockData[0].symbol to get the stock symbol\n\n      // Replace this with your actual logic for fetching historical data\n      const historicalData = await fetchHistoricalDataFromBackend();\n      updateMarkers(historicalData);\n    };\n\n    fetchHistoricalData();\n  }, [stockData]); // Trigger when stockData changes\n\n  const updateMarkers = (historicalData) => {\n    if (historicalData) {\n      const updatedLocations = locationData.map((location) => {\n        const indexFund = indexFunds[location.name];\n        if (indexFund && historicalData[indexFund.ticker]) {\n          const historicalPrices = historicalData[indexFund.ticker];\n          const currentPrice = historicalPrices[historicalPrices.length - 1].close;\n          const previousPrice = historicalPrices[historicalPrices.length - 2].close;\n          const isPriceIncreased = currentPrice > previousPrice;\n\n          return {\n            ...location,\n            isPriceIncreased,\n          };\n        }\n        return location;\n      });\n\n      setLocationData(updatedLocations);\n    }\n  };\n\n  return (\n    <>\n      {error ? (\n        <p>{error}</p>\n      ) : apiKey ? (\n        <LoadScript googleMapsApiKey={apiKey}>\n          <GoogleMap mapContainerStyle={containerStyle} center={center} zoom={2}>\n            {locationData.map((location, index) => (\n              <Marker\n                key={index}\n                position={location}\n                title={location.name}\n                icon={{\n                  url: location.isPriceIncreased\n                    ? 'https://www.freeiconspng.com/uploads/green-spot-light-png-11.png'\n                    : 'https://www.freeiconspng.com/uploads/red-spot-light-png-6.png',\n                  scaledSize: { width: 100, height: 100 },\n                }}\n              />\n            ))}\n          </GoogleMap>\n        </LoadScript>\n      ) : (\n        <p>Loading map...</p>\n      )}\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}